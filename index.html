<!DOCTYPE html>
<html>
    <head>
        <title>Ponto no Plano Cartesiano!</title>
        <meta charset=UTF-8>
        <link rel="shortcut icon" type="image/x-icon" href="https://1001freedownloads.s3.amazonaws.com/icon/thumb/337263/Cursor-Move-icon.png">
        <link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto">
        <link rel=stylesheet href="https://fonts.googleapis.com/css?family=Raleway">
        <link rel=stylesheet href="https://fonts.googleapis.com/css?family=Merriweather">
    </head>
    <style>
        body {
            background-color: silver;
            margin-left: -8px;
            padding-left: 16px;
        } canvas {
            box-shadow: black 3px 3px 2px;
        } .parag, input[type=number] {
            font-family: Roboto;
            color: white;
        } input[type=number] {
            background-color: tomato;
            color: white;
            box-shadow: black 1px 1px 2px;
            text-shadow: black 1px 1px 1px;
            border: none;
            border-radius: 6px;
            padding: 3px;
        } #mens, input[type=button] {
            font-family: Raleway; 
        } input[type=button] {
            color: rgb(225,225,225);
            font-size: 16px;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            box-shadow: rgba(0,0,0,0.5) 2px 2px 2px;
            background-color: rgba(255,99,110,0.5);
            padding-top: 10px;
            padding-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        } input[type=button]:hover {
            background-color: rgba(255,0,0,0.5);
        } .p1 {
            font-size: 50px;
            font-weight: bold;
            text-align: center;
            text-shadow: black 2px 2px 3px;
        } .p2, input[type=number] {
            font-size: 20px;
            text-shadow: black 1px 1px 2px;
        } p, li {
            margin-top: 5px;
            margin-bottom: 5px;
        } #mens {
            font-size: 20px;
            position: absolute;
            display: none;
            justify-content: center;
            align-items: center;
            width: 880px;
            height: 50px;
            padding: 10px;
            background-color: rgba(0,0,0,0.6);
            color: silver;
            margin: 0px;
            margin-top: -73px;
            opacity: 0;
        } #planoArtc {
            width: 900px;
            height: 700px;
            background-color: white;
            cursor: grab;
        } #planoArtc, #plano, #mens {
            border-radius: 20px;
        } #quadrante {
            font-family: Merriweather;
            color: white;
            text-shadow: rgba(0,0,0,0.6) 3px 3px 2px;
            padding-top: 20px;
            font-size: 24px;
        } .zoomIcon {
            width: 26px;
            height: 26px;
            cursor: pointer;
            filter: invert(0);
            transition: filter 0.25s;
        } .zoomIcon:hover {
            filter: invert(0.4);
        } #buttBack {
            display: none;
        }
    </style>
    <body>
        <section style="background-color: maroon; margin: 30px; border-radius: 30px; box-shadow: black 3px 3px 4px; margin-left: auto; margin-right: auto; padding: 60px; width: 940px">
            <p class="parag p1">Insira as coordenadas abaixo:</p>
            <ul>
                <li class="parag p2"><input type=number id=cX> Coordenada X</li>
                <li class="parag p2"><input type=number id=cY> Coordenada Y</li>
            </ul>
            <article style="width: 26px; box-shadow: black 2px 2px 2px; float: right; padding: 4px; padding-top: 10px; padding-bottom: 10px; border-radius: 19px; background-color: silver">
                <img src="https://image.flaticon.com/icons/png/512/51/51537.png" class=zoomIcon>
                <img src="https://image.flaticon.com/icons/png/512/51/51363.png" class=zoomIcon>
            </article>
            <article id=planoArtc>
                <canvas id=plano width=900 height=700></canvas>
                <p id=mens>Para dar zoom no plano,&nbsp;<b>pressione Shift</b>&nbsp;e role a roda do mouse!&nbsp;<input type=button value="Não mostrar mais esta mensagem!" onclick="noMoreMens()"></p>
            </article>
            <ul>
                <li id=quadrante></li>
            </ul>
            <p style="text-align: center"><input type=button value="Voltar para o quadro inicial!" id=buttBack></p>
        </section>
    </body>
    <script>
        var press = false;
        var canMove = false;
        var centerX = plano.width/2; //---> Posição do valor x = 0!
        var centerY = plano.height/2; //---> Posição do valor y = 0!
        var cRefX;
        var cRefY;
        var grabCnvs = [];
            grabCnvs[false] = "grab";
            grabCnvs[true] = "grabbing";
        var alignTxtCnv = ["center", "left"];
        var corpo = document.querySelector("body");
        var cnv = document.getElementById("plano");
        var cnvArtc = document.getElementById("planoArtc");
        var ctx = cnv.getContext("2d");
        ctx.font = "bold 15px Arial";
        ctx.shadowOffsetX = 1;
        ctx.shadowOffsetY = 1;
        ctx.shadowBlur = 2;
        var pRefX;
        var pRefY;
        var shiftAct = false;
        var valueUnit = 40;
        var quantOpcty = 0;
        var quantZoom = 0;
        const fraseQuadr = "Onde o ponto está localizado?";
        quadrante.innerHTML = fraseQuadr;
        var intOpcty;
        var intNxtOpcty;
        function noMoreMens() {
            clearInterval(intOpcty);
            clearInterval(intNxtOpcty);
            intOpcty = setInterval(function() {
                quantOpcty--;
                mens.style.opacity = (1 - Math.cos(Math.PI*quantOpcty/50))/2;
                if(quantOpcty == 0) {
                    clearInterval(intOpcty);
                    mens.style.display = "none";
                }
            }, 20);
        } function opctyMens(valuetime) {
            setTimeout(function() {
                mens.style.display = "flex";
                intOpcty = setInterval(function() {
                    quantOpcty++;
                    mens.style.opacity = (1 - Math.cos(Math.PI*quantOpcty/50))/2;
                    if(quantOpcty == 50) {
                        clearInterval(intOpcty);
                        intNxtOpcty = setTimeout(function() {
                            intOpcty = setInterval(function() {
                                quantOpcty--;
                                mens.style.opacity = (1 - Math.cos(Math.PI*quantOpcty/50))/2;
                                if(quantOpcty == 0) {
                                    clearInterval(intOpcty);
                                    mens.style.display = "none";
                                    opctyMens(1);
                                }
                            }, 20);
                        }, 3000)
                    }
                }, 20);
            }, 1000 + valuetime*59000);
        } function positCursor(newcond, newid) {
            if(newcond == false) { //---> Posição X
                return (event.clientX - document.getElementById(newid).offsetLeft + window.scrollX);
            } else if(newcond == true) { //---> Posição Y
                return (event.clientY - document.getElementById(newid).offsetTop + window.scrollY);
            } else {
                return undefined;
            }
        } function cMTrueFunc() {
            moveChg(true);
            pRefX = positCursor(false, "plano");
            pRefY = positCursor(true, "plano");
            cRefX = centerX;
            cRefY = centerY;
        } function changePosit() {
            centerX = cRefX + positCursor(false, "plano") - pRefX;
            centerY = cRefY + positCursor(true, "plano") - pRefY;
            avaliarGph();
            createGph();
        } function moveChg(newvalueChg) {
            canMove = newvalueChg;
            cnvArtc.style.cursor = grabCnvs[canMove];
        }  function funcIniciar() {
            createGph();
            opctyMens(0);
        } function inserPoint() {
            valueX = parseFloat(cX.value);
            valueY = parseFloat(cY.value);
            quadrante.innerHTML = fraseQuadr;
            if((isNaN(valueX) || isNaN(valueY)) && condDrawPoint == true) {
                condDrawPoint = false;
                createGph();
            } else if(isNaN(valueX) == false && isNaN(valueY) == false && condDrawPoint == false) {
                condDrawPoint = true;
            } if(condDrawPoint == true) {
                createGph();
                var complem = " <b>";
                if(valueX == 0 || valueY == 0) {
                    if(valueX == 0 && valueY !== 0) {
                        complem += "Eixo vertical (ordenada)"
                    } else if(valueX !== 0 && valueY == 0) {
                        complem += "Eixo horizontal (abscissa)"
                    } else {
                        complem += "Ponto de origem"
                    }
                } else {
                    complem += "Quadrante ";
                    if(valueX > 0) {
                        if(valueY > 0) {
                            complem += "I"
                        } else {
                            complem += "IV"
                        }
                    } else {
                        if(valueY > 0) {
                            complem += "II"
                        } else {
                            complem += "III"
                        }
                    }
                } complem += "</b>"
                quadrante.innerHTML += complem;
            }
        } var condDrawPoint = false;
        var valueX;
        var valueY;
        const baseTrg = 30/Math.pow(3, 0.5);
        function createGph() {
            function bckGrdValue(valueopcty) {
                bckGrd = ctx.createRadialGradient(positXArc + 12, positYArc - 12, 0, positXArc + 12, positYArc - 12, 30);
                bckGrd.addColorStop(0, "rgba(255,69,0," + valueopcty + ")");
                bckGrd.addColorStop(1, "rgba(128,0,0," + valueopcty + ")");
                ctx.fillStyle = bckGrd;
                ctx.shadowColor = "rgba(0,0,0," + 0.5*valueopcty + ")";
            } ctx.shadowColor = "transparent";
            ctx.fillStyle = "white";
            ctx.fillRect(0, 0, cnv.width, cnv.height);
            ctx.fillStyle = "black";
            var varZoom = Math.pow(2, quantZoom);
            var positMin = new Array(2);
            var positMax = new Array(2);
            var conjPositValue = new Array(2);
            drawEixo(centerX, 0, false);
            drawEixo(centerY, 1, false);
            if(condDrawPoint == true) {
                var valueUnitRes = valueUnit/varZoom;
                var positXArc = centerX + valueX*valueUnitRes;
                var positYArc = centerY - valueY*valueUnitRes;
                var positYP = positYArc - 15;
                if(positXArc > -12 && positXArc < cnv.width + 10 && positYArc > -12 && positYArc < cnv.height + 10) {
                    var bckGrd;
                    bckGrdValue(1);
                    ctx.beginPath();
                    ctx.arc(positXArc, positYArc, 10, 0, 2*Math.PI, false);
                    ctx.fill();
                } if(positXArc >= 0 && positXArc <= cnv.width && positYP >= 0 && positYP <= cnv.height + 20) {
                    var opctyCoord = 1;
                    if(positXArc < 40) {
                        opctyCoord = positXArc/40;
                    } else if(positXArc > cnv.width - 40) {
                        opctyCoord = (cnv.width - positXArc)/40;
                    } bckGrdValue(opctyCoord);
                    ctx.font = "bold 20px Roboto";
                    ctx.textAlign = "center";
                    ctx.beginPath();
                    ctx.fillText("P(" + valueX + ", " + valueY + ")", positXArc, positYArc - 20);
                    ctx.font = "bold 15px Roboto";
                } if(positXArc < 0 || positXArc > cnv.width || positYArc < 0 || positYArc > cnv.height) {
                    var pointX;
                    var pointY;
                    var pointX2;
                    var pointY2;
                    var pointX3;
                    var pointY3;
                    var consA = (positYArc - cnv.height/2)/(positXArc - cnv.width/2);
                    if(Math.abs(consA) <= cnv.height/2) {
                        var consB = cnv.height/2 - consA*cnv.width/2;
                        var valor1 = consA*10 + consB;
                        var valor2 = consA*(cnv.width - 10) + consB;
                        var valor3 = (10 - consB)/consA;
                        var valor4 = (cnv.height - 10 - consB)/consA;
                        if(valor1 > 10 && valor1 < cnv.height - 10 && positXArc <= -12) {
                            pointX = 10;
                            pointY = valor1;
                        } else if(valor2 > 10 && valor2 < cnv.height - 10 && positXArc >= cnv.width + 10) {
                            pointX = cnv.width - 10;
                            pointY = valor2;
                        } else if(valor3 >= 10 && valor3 <= cnv.width - 10 && positYArc <= -12) {
                            pointX = valor3;
                            pointY = 10;
                        } else if(valor4 >= 10 && valor4 <= cnv.width - 10 && positYArc >= cnv.height + 10) {
                            pointX = valor4;
                            pointY = cnv.height - 10;
                        } var conjRaizQuad = raizQuadr(consA, consB, pointX, pointY, 40);
                        var baseX;
                        if(pointX < cnv.width/2) {
                            baseX = conjRaizQuad[1]; //---> Maior raiz
                        } else if(pointX > cnv.width/2) {
                            baseX = conjRaizQuad[0]; //---> Menor raiz
                        } var ybaseX = consA*baseX + consB;
                        if(Math.abs(consA*cnv.width/2) >= 1) {
                            var newconsA = Math.tan(Math.atan(consA) - Math.PI*consSign(consA, false)/2);
                            var newconsB = (consA - newconsA)*baseX + consB;
                            var conjRaizQuad2 = raizQuadr(newconsA, newconsB, baseX, ybaseX, baseTrg);
                            pointX2 = conjRaizQuad2[0];
                            pointY2 = newconsA*pointX2 + newconsB;
                            pointX3 = conjRaizQuad2[1];
                            pointY3 = newconsA*conjRaizQuad2[1] + newconsB;
                        } else {
                            pointY2 = pointY - baseTrg;
                            pointY3 = pointY + baseTrg;
                            if(positXArc <= -12) {
                                pointX2 = 50;
                                pointX3 = 50;
                            } else if(positXArc >= cnv.width + 10) {
                                pointX2 = cnv.width - 50;
                                pointX3 = cnv.width - 50;
                            }
                        }
                    } else {
                        pointX = cnv.width/2;
                        pointX2 = pointX - baseTrg;
                        pointX3 = pointX + baseTrg;
                        if(positYArc <= -12) {
                            pointY = 10;
                            pointY2 = 50;
                            pointY3 = 50;
                        } else if(positYArc >= cnv.height + 10) {
                            pointY = cnv.height - 10;
                            pointY2 = cnv.height - 50;
                            pointY3 = cnv.height - 50;
                        }
                    } var distPoint = Math.pow(Math.pow(positXArc - pointX, 2) + Math.pow(positYArc - pointY, 2), 0.5);
                    var opctySeta;
                    if(distPoint > 600) {
                        opctySeta = 1;
                    } else {
                        opctySeta = distPoint/600;
                    } ctx.fillStyle = "rgba(155,155,155," + opctySeta + ")";
                    ctx.beginPath();
                    ctx.shadowColor = "rgba(0,0,0," + opctySeta*0.7 + ")";
                    ctx.lineTo(pointX, pointY);
                    ctx.lineTo(pointX2, pointY2);
                    ctx.lineTo(pointX3, pointY3);
                    ctx.fill();
                }
            }
            drawEixo(centerX, 0, true);
            drawEixo(centerY, 1, true);
            ctx.font = "bold 15px Roboto";
            function drawEixo(valuePrinc, valuecond, valuecond2) {
                //Caso "valuecond" for zero, eixos verticais; caso um, eixos horizontais!
                if(valuecond2 == false) { //---> Inserir linhas horizontais e verticais
                    var medida = cnv.width*(1 - valuecond) + cnv.height*valuecond;
                    positMin[valuecond] = -valuePrinc/valueUnit;
                    var acresc = (Math.ceil(positMin[valuecond]) - positMin[valuecond])*valueUnit;
                    positMin[valuecond] = Math.ceil(positMin[valuecond]);
                    var min = positMin[valuecond];
                    positMax[valuecond] = min + Math.floor((medida - 1 - acresc)/valueUnit);
                    conjPositValue[valuecond] = new Array();
                    for(var y = min - 1; y <= positMax[valuecond] + 1; y++) {
                        const yCons = y*varZoom;
                        var eixo = Math.pow(0, Math.abs(y));
                        var positValue = Math.ceil(acresc + (y - min)*valueUnit - 2*eixo) - 1;
                        conjPositValue[valuecond].push(positValue);
                        var compr = (1 + 4*eixo)*(1 - valuecond) + cnv.width*valuecond;
                        var alt = medida*(1 - valuecond) + (1 + 4*eixo)*valuecond;
                        ctx.fillRect(positValue*(1 - valuecond), positValue*valuecond, compr, alt);
                    }
                } else if(valuecond2 == true) { //---> Inserir texto indicando os valores x e y
                    ctx.textAlign = alignTxtCnv[valuecond];
                    for(var y = positMin[valuecond] - 1; y <= positMax[valuecond] + 1; y++) {
                        const yCons = y*varZoom;
                        var positConj = conjPositValue[valuecond][y - positMin[valuecond] + 1];
                        if(y % 5 == 0) {
                            var positXTxt = positConj*(1 - valuecond) + 2;
                            var positYTxt = cnv.height*(1 - valuecond) + positConj*valuecond - 1;
                            var opcty;
                            var positCond = positXTxt*(1 - valuecond) + positYTxt*valuecond;
                            var medCond = cnv.width*(1 - valuecond) + (cnv.height - 15)*valuecond;
                            if(positCond >= 0 && positCond <= medCond) {
                                if(positCond < 15) {
                                    opcty = positCond/15;
                                } else if(positCond > medCond - 15) {
                                    opcty = (medCond - positCond)/15;
                                } else {
                                    opcty = 1;
                                } var valuecolor = 100 + 80*Math.pow(0, Math.abs(y))*(1 - valuecond);
                                ctx.fillStyle = "rgba(" + valuecolor + "," + valuecolor + "," + valuecolor + "," + opcty + ")";
                                ctx.shadowColor = "rgba(0,0,0," + opcty*0.4 + ")";
                                ctx.fillText(yCons*Math.pow(-1, valuecond), positXTxt, positYTxt);
                                ctx.shadowColor = "transparent";
                                ctx.fillStyle = "black";
                            }
                        }
                    }
                }
            }
        } function raizQuadr(consQuadr1, consQuadr2, consQuadr3, consQuadr4, consQuadr5) {
            return funcQuadratic(/*Constante A*/Math.pow(consQuadr1, 2) + 1, /*Constante B*/2*consQuadr1*consQuadr2 - 2*consQuadr3 - 2*consQuadr1*consQuadr4, /*Constante C*/Math.pow(consQuadr4, 2) - 2*consQuadr2*consQuadr4 + Math.pow(consQuadr2, 2) + Math.pow(consQuadr3, 2) - Math.pow(consQuadr5, 2));
        } function consSign(newvalue, newcons) {
            var newconsSign = newvalue/(Math.abs(newvalue) + Math.pow(0, Math.abs(newvalue))) + Math.pow(0, Math.abs(newvalue)); //---> -1 caso for negativo não-nulo; 1 caso for positivo nulo!
            if(newcons == true) {
                newconsSign += Math.pow(0, newconsSign + 1); //---> 0 caso for negativo não-nulo; outros casos mantém-se 1!
            } if(newcons == false || newcons == true) {
                return newconsSign;
            } else {
                return undefined;
            }
        } function funcQuadratic(consAQuadr, consBQuadr, consCQuadr) {
            var delta = Math.pow(consBQuadr, 2) - 4*consAQuadr*consCQuadr;
            if(delta < 0) {
                return undefined;
            } else if(delta == 0) {
                return [-consBQuadr/(2*consAQuadr)];
            } else {
                delta = Math.pow(delta, 0.5);
                return [-(delta + consBQuadr)/(2*consAQuadr), (delta - consBQuadr)/(2*consAQuadr)].sort(function(a, b) { return (a - b)}); //---> Ordenar do menor para o maior!
            }
        } function zoomDraw(newcons1, newcons2, newcons3, newcons4) {
            var consMulti = Math.pow(newcons2, Math.pow(-1, newcons1));
            centerX = newcons3 - (newcons3 - centerX)*consMulti;
            centerY = newcons4 - (newcons4 - centerY)*consMulti;
            valueUnit *= consMulti;
            var unit;
            if(valueUnit < 30) {
                unit = Math.floor(30/valueUnit);
                quantZoom += unit;
                valueUnit *= 2*unit;
            } else if(valueUnit >= 60) {
                unit = Math.floor(valueUnit/60);
                quantZoom -= unit;
                valueUnit /= 2*unit;
            } createGph();
            avaliarGph();
        } function avaliarGph() {
            var displButt;
            if(centerX == plano.width/2 && centerY == plano.height/2 && valueUnit == 40 && quantZoom == 0) {
                displButt = "none";
            } else {
                displButt = "inline";
            } document.getElementById("buttBack").style.display = displButt;
        } corpo.addEventListener("DOMContentLoaded", funcIniciar());
        corpo.addEventListener("mousedown", function() { press = true });
        corpo.addEventListener("mouseup", function() { press = false });
        corpo.addEventListener("keydown", function() { if(event.keyCode == 16) /*Tecla Shift pressionada!*/ { shiftAct = true } });
        corpo.addEventListener("keyup", function() { shiftAct = false });
        cnvArtc.addEventListener("mousedown", function() { cMTrueFunc() });
        cnvArtc.addEventListener("mouseup", function() { moveChg(false) });
        cnvArtc.addEventListener("mouseout", function() { moveChg(false) });
        cnvArtc.addEventListener("mouseover", function() { if(press == true) { cMTrueFunc() } });
        cnvArtc.addEventListener("mousemove", function() { if(canMove == true) { changePosit() } });
        cnvArtc.addEventListener("mousewheel", function() {
            if(shiftAct == true) {
                var positX = positCursor(false, "plano");
                var positY = positCursor(true, "plano")
                var consWheel = event.deltaY/Math.abs(event.deltaY);
                consWheel += Math.pow(0, consWheel + 1);
                zoomDraw(consWheel, 1.5*Math.abs(event.deltaY/100), positX, positY);
            }
        });
        document.getElementById("buttBack").addEventListener("click", function() {
            centerX = cnv.width/2;
            centerY = cnv.height/2;
            quantZoom = 0;
            valueUnit = 40;
            createGph();
            document.getElementById("buttBack").style.display = "none";
        });
        for(var s = 0; s <= 1; s++) {
            document.getElementsByTagName("input")[s].addEventListener("input", function() { inserPoint() });
            const sCons = s;
            document.getElementsByClassName("zoomIcon")[s].addEventListener("click", function() { zoomDraw(sCons, 1.5, cnv.width/2, cnv.height/2) });
        }
    </script>
</html>